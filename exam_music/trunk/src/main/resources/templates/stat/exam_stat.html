<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout" layout:decorator="layout">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>考试统计分析</title>
</head>
<body>
	<div layout:fragment="content">
		<div class=" pull-left main-content">
			<div class="content-item">
				<p class="title">考试统计分析&nbsp;&nbsp;&nbsp;&nbsp;<a class="layui-btn layui-btn-small del-btn" id="autoScore" th:href="@{/exam_paper_stat}">考卷统计分析</a>&nbsp;&nbsp;&nbsp;&nbsp;<a class="layui-btn layui-btn-small del-btn" id="autoScore" th:href="@{/examinee_stat}">考生统计分析</a></p>
				<form class="layui-form search-form" th:action="@{/exam_stat}">
					<div class="layui-form-item">
						<div class="layui-inline">
							<label class="layui-form-label">年度：</label>
							<div class="layui-input-inline">
								<select class="form-control" id="year">
									<option th:each="i:${#numbers.sequence(currentYear-3,currentYear)}" th:value="${i}" th:text="${i}" th:selected="${i==currentYear}"></option>
								</select>
							</div>
						</div>
						<div class="layui-inline">
							<label class="layui-form-label">考试：</label>
							<div class="layui-input-inline w180">
								<select name="exam_id" class="form-control" id="exam_id">
									<option th:each="exam : ${exams}" th:value="${exam.id}" th:text="${exam.title}"></option>
								</select>
							</div>
						</div>
						<button class="btn">查询</button>
					</div>
				</form>
				<table class="layui-table" lay-skin="line">
					<colgroup>
						<col width="">
						<col width="">
						<col width="">
						<col width="">
						<col width="">
						<col width="">
						<col width="">
						<col width="">
						<col width="">
						<col width="">
					</colgroup>
					<thead>
						<tr>
							<th>考卷名称</th>
							<th>考卷总分</th>
							<th>平均得分</th>
							<th>A（90分以上）</th>
							<th>B（80-90分）</th>
							<th>C（80-70分）</th>
							<th>D（70-60分）</th>
							<th>E（60分以下）</th>
							<th>难度系数</th>
							<th>实测难度系数</th>
						</tr>
					</thead>
					<tbody>
						<tr th:if="${data!=null}" th:each="dataMap : ${data}">
							<td th:text="${dataMap.key}"></td>
							<td th:text="${dataMap.value['full_score']}"></td>
							<td th:text="${dataMap.value['average_score']}"></td>
							<td th:text="${dataMap.value['percent_ninety']}"></td>
							<td th:text="${dataMap.value['percent_eighty']}"></td>
							<td th:text="${dataMap.value['percent_seventyty']}"></td>
							<td th:text="${dataMap.value['percent_sixty']}"></td>
							<td th:text="${dataMap.value['less_percent_sixty']}"></td>
							<td th:text="${dataMap.value['epaper_diff']}"></td>
							<td th:text="${dataMap.value['reality_diff']}"></td>
						</tr>
						<tr th:if="${#maps.isEmpty(data)}">
							<td colspan="10">暂无数据</td>
						</tr>
					</tbody>
				</table>
			</div>
			<div>
				<input type="hidden" id="papers" th:value="${papers}">
				<input type="hidden" id="lessSixtyData" th:value="${lessSixtyData}">
				<input type="hidden" id="sixtyData" th:value="${sixtyData}">
				<input type="hidden" id="seventyData" th:value="${seventyData}">
				<input type="hidden" id="eightyData" th:value="${eightyData}">
				<input type="hidden" id="ninetyData" th:value="${ninetyData}">
			</div>
			<div th:if="${!#maps.isEmpty(data)}" id="main-charts"></div>
			<script th:src="@{/js/lib/echarts.min.js}"></script>
			<script th:src="@{/js/modules/exam.js}"></script>
			<script type="text/javascript">
				var papers = document.getElementById('papers').value.split("$");
				var lessSixtyData = document.getElementById('lessSixtyData').value.split(",");
				var sixtyData = document.getElementById('sixtyData').value.split(",");
				var seventyData = document.getElementById('seventyData').value.split(",");
				var eightyData = document.getElementById('eightyData').value.split(",");
				var ninetyData = document.getElementById('ninetyData').value.split(",");
				var myChart = echarts.init(document.getElementById('main-charts'));
				var option = {
					    tooltip : {
					        trigger: 'axis',
					        axisPointer : {
					            type : 'shadow'
					        }
					    },
					    legend: {
					        data:['A（90分以上）','B（80-90分）','C（70-80分）','D（60-70分）','E（60分以下）']
					    },
					    grid: {
					        left: '3%',
					        right: '4%',
					        bottom: '3%',
					        containLabel: true
					    },
					    xAxis : [
					        {
					            type : 'category',
					            data : papers
					        }
					    ],
					    yAxis :[
							{
								type: "value",
								name: '人数'
							}
								],
					    series : [
					              {
							            name:'A（90分以上）',
							            type:'bar',
							            barWidth : 30,
							            data:ninetyData
							        },
							        {
							            name:'B（80-90分）',
							            type:'bar',
							            barWidth : 30,
							            data:eightyData
							        },
							        {
							            name:'C（70-80分）',
							            type:'bar',
							            barWidth : 30,
							            data:seventyData
							        },
							        {
							            name:'D（60-70分）',
							            type:'bar',
							            barWidth : 30,
							            data:sixtyData
							        },
							        {
									    name:'E（60分以下）',
									    type:'bar',
									    barWidth : 30,
									    data:lessSixtyData
									}
					    ]
					};
				myChart.setOption(option);
			</script>

		</div>
	</div>
</body>
</html>